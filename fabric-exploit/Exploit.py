from Crypto.Util.number import *
import gmpy2
import GetPrime as GP


n = 72474949932211166156492654735245747968843831840713439437314576089498460086808953859000321660902180121494838901541597303069385890047707566698245869287314238983570656736129991971258818769519723573637085308414071343170124304941274941183952998003394973200915811588861687023879639921954385429491370242450311697923
e1 = 102469063688270886260021685918015787947238165646338618222470890162881394502509461579892536219739420778568378501754569824288512089189382477008583319567828687207636890147732793587510678511310383803067741401969853700450601526242340590241142818192254115394231858435693802821754283336993656618018425890114276198055 
d1 = 44120963708683130438884575369037513832250302091688339552067101225524854298622141177692065682661104716283617956020209228909830030392861095350155740382813267612463230641818256461304556853007030351649243546013373597922940669419075387075827457435279601558325258286605895680994697952497666673734392533642277974551
print("n",n,"e1",e1,"d1",d1)

q,p = GP.getpq(n, e1, d1)
p = int(p)
q = int(q)
print("q",q,"p",p)
phi = (p-1)*(q-1)
#print(int(phi))

e2 = 85611159889933399232249524467034233368411542122792095352920527184273043939070255565183453224135519055484783940137057801188581245298594360067744676449625364217587049630041394640177382093888407163840172180756864696604868956072737933574569398369696133489865231065904380308178200332631883816717161289253241981879
m = "hello, this it my message"
c = pow(bytes_to_long(m), e2, n)
print("m",m,"c",c)

d2 = gmpy2.invert(e2, phi)
_m = long_to_bytes(pow(c, d2, n))
print("d2",d2,"the m by (d2,n) decode:",_m)



